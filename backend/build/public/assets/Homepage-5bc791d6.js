import{u as S,w as v,r as h,x as E,a as m,j as e,t as C,y as J,F as R,M as Y,z as G,o as X,b as q,A as j,B as Z,C as ee,D as te,E as ne,p as z,I as se,J as T,H as ie,O as oe}from"./index-1b29304c.js";import{B as b,c as B}from"./Button-d803f768.js";import{u as x,q as re,B as ae}from"./useKey-3822b23a.js";import{a as le,b as ce,d as ue,c as de,B as fe,Q as me}from"./QuestionLoader-1ad1b6b7.js";import{u as ge}from"./user.service-e05af429.js";import{s as pe}from"./config-2b6c6df4.js";import{E as xe}from"./ErrMsg-e8c48b48.js";import"./Modal-f02bc630.js";import"./useOutsideClick-90568c18.js";const he=()=>{const s=S(),{language:t,numQuestions:r}=v(),[i,c]=h.useState(!1);x("Enter",u),x("ArrowDown",d),x("ArrowUp",g);function u(){s(E("active"))}function g(){c(!1)}function d(){c(!0)}return m("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${t} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${r} question to test your ${t} mastery`}),r>0&&e(b,{onClickFn:u,className:B("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":i}),children:"Let's start"})]})},we=()=>{const{numQuestions:s,questionIdx:t,points:r,maxPossiblePoints:i,answerIdx:c}=v();return m("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(c!==null),max:s,className:"quiz-progress-bar col-span-full h-4 w-full"}),m("p",{children:["Question ",e("strong",{children:t+1}),"/",s]}),m("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:r}),"/",i]})]})},ye=()=>{const s=S(),{questions:t,isTimerOn:r,secondsPerQuestion:i}=v(),[c,u]=h.useState(t.length*i),g=h.useRef(null),d=Math.floor(c/60),f=c%60;function p(){g.current&&clearInterval(g.current)}return h.useEffect(()=>(s(C(!0)),()=>{s(C(!1))}),[s]),h.useEffect(()=>{function w(){g.current=setInterval(()=>{u(n=>n===0?(s(E("finished")),n):n-1)},1e3)}return r?w():p(),()=>{p()}},[r,s]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:m("span",{children:[d<10&&"0",d,":",f<10&&"0",f]})})},ve=()=>{const s=S(),{isTimerOn:t}=v();function r(){s(C(!t))}const i=h.useRef(J()).current;return m(R,{children:[e("button",{onClick:r,"data-tooltip-id":i,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(Y,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(G,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(re,{id:i,style:{fontSize:"16px"},className:"hidden md:block"})]})},P=h.createContext(void 0);function Qe({children:s}){const t=S(),r=X(),{loggedInUser:i}=q(),{questions:c,questionIdx:u,numQuestions:g,answerIdx:d,points:f,highScore:p,isTimerOn:w}=v(),[n,l]=h.useState(""),a=c[u],y=i==null?void 0:i.roles.includes("admin"),k=d!==null,Q=u===g-1;x("Enter",D,{},[n]),x("ArrowRight",M,{},[n]),x("ArrowLeft",L,{},[n]),x("ArrowUp",$,{},[d,n]),x("ArrowDown",H,{},[d,n]),x("e",W,{},[a.id,y]),x("a",_,{},[y,a.isRevised]),x("m",K,{},[y,a.isMarkedToBeRevised]),x("t",U,{},[w]);function M(){l("next")}function L(){l("quit")}function $(){if(d)return;let o="";const N=a.options.length;if(n==="")o="option-1";else if(n.includes("option")){const A=Number(n.split("-")[1]);A===1?o=`option-${N}`:o=`option-${A-1}`}else n?o=`option-${N+1}`:o="option-1";l(o)}function H(){if(d)return;let o="";const N=a.options.length;if(n.includes("option")){const A=Number(n.split("-")[1]);A===N?o="option-1":o=`option-${A+1}`}else o="option-1";l(o)}function D(){if(n==="next")I();else if(n==="quit")O();else if(n.includes("option")){const o=Number(n.split("-")[1]);F(o-1)}l("")}function O(){t(j())}function F(o){t(Z(o)),a.correctOption===o&&(t(ee(a.points)),i&&ge.recordUserCorrectAnswer(a))}function I(){if(d===null)return;u>=0&&u<g-1?t(te()):Q&&(t(E("finished")),f>p&&t(ne(f)))}function U(){t(C(!w))}function W(){y&&(t(C(!1)),r(`question-edit/${a.id}`))}function _(){if(!y)return;const o={...a,isRevised:!a.isRevised};t(z(o,"approve"))}function K(){if(!y)return;const o={...a,isMarkedToBeRevised:!a.isMarkedToBeRevised};t(z(o,"mark"))}h.useEffect(()=>{function o(){n!==""&&l("")}return document.addEventListener("mousemove",o),()=>{document.removeEventListener("mousemove",o)}},[n]);const V={focusedBtn:n,question:a,isNextBtnShown:k,isLastQuestionIdx:Q,onPassQuestion:I,handleQuitClick:O,onOptionSelection:F};return e(P.Provider,{value:V,children:s})}function Ne(){const s=h.useContext(P);if(s===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return s}const be=()=>{const{loggedInUser:s}=q(),t=s==null?void 0:s.roles.includes("admin"),{focusedBtn:r,question:i,isNextBtnShown:c,isLastQuestionIdx:u,onPassQuestion:g,handleQuitClick:d,onOptionSelection:f}=Ne(),{answerIdx:p}=v();return i?m("section",{className:"w-full max-w-[575px] px-14",children:[e(we,{}),m("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:i.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:i.options.map((w,n)=>{const l=p!==null,a=p===n,y=l&&i.correctOption===n;return e(b,{className:B("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":a,correct:y,wrong:l&&!y,"translate-x-5 !bg-gray-800 text-gray-200":r===`option-${n+1}`,"!cursor-not-allowed":p!==null}),onClickFn:()=>f(n),disabled:l,children:w},n)})})]}),m(se,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(ye,{}),c&&e(b,{onClickFn:g,className:B("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":r==="next"}),children:e("span",{children:u?"Finish":"Next"})}),e(b,{onClickFn:d,className:B("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":r==="quit"}),children:e("span",{children:"Quit"})}),t&&m("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(ve,{}),e(ae,{question:i}),e(le,{question:i}),e(ce,{question:i}),e(ue,{question:i}),e(de,{questionId:i.id}),e(fe,{question:i})]})]})]}):null},Be=()=>{const s=S(),{language:t,level:r,page:i,points:c,maxPossiblePoints:u,highScore:g,numQuestions:d}=v(),f=c/u*100,[p,w]=h.useState("none"),n=h.useRef("none");let l;f===100?l="ðŸ¥³":f>=80?l="ðŸ˜Ž":f>=60?l="ðŸ™‚":l="ðŸ˜ž";function a(){s(T({language:t,level:r,page:i+1,limit:d}))}function y(){s(j())}x("ArrowRight",()=>{w(Q=>"restart")}),x("ArrowLeft",()=>{w(Q=>"newQuiz")}),x("Enter",()=>{const Q=n.current;Q==="newQuiz"?a():Q==="restart"&&y()});function k(){w(Q=>"none")}return h.useEffect(()=>(document.addEventListener("mousemove",k),()=>{document.removeEventListener("mousemove",k)}),[]),h.useEffect(()=>{n.current=p},[p]),m("section",{className:"flex flex-col items-center gap-12 px-4",children:[m("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:l}),"You scored ",e("strong",{children:c})," out of"," ",e("strong",{children:u})," points. (",Math.ceil(f),"%)"]}),m("p",{className:"text-center text-3xl",children:["(Highscore: ",g," points)"]}),m("div",{className:"flex items-center justify-center gap-5",children:[e(b,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":p==="newQuiz"}),onClickFn:a,children:"Start New Quiz"}),e(b,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":p==="restart"}),onClickFn:y,children:"Restart"})]})]})},Se=()=>{const{language:s}=v(),t=pe.programmingLanguages[s];if(!t)return null;const{img:r}=t;return m(ie,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:r,alt:"logo",className:"h-20 w-20 object-contain"})]})},ke=({children:s,className:t})=>e("main",{className:t,children:s}),Re=()=>{const s=S(),{loggedInUser:t}=q(),{status:r,language:i,level:c,page:u,questions:g}=v();function d(f){switch(f){case"loading":return e(me,{});case"error":return e(xe,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(he,{});case"active":return e(Qe,{children:e(be,{})});case"finished":return e(Be,{});default:return e(R,{})}}return h.useEffect(()=>{if(g.length>0)return;function f(){if(!t)s(T({language:i,level:c,page:u}));else{const{language:p,level:w,numQuestions:n,secondsPerQuestion:l}=t.quizSettings;s(T({language:p,level:w,limit:n,secondsPerQuestion:l}))}}return f(),()=>{f()}},[t,i,c,u,s,g.length]),m(ke,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(Se,{}),d(r),e(oe,{})]})};export{Re as default};
