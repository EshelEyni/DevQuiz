import{b as S,a as j,N as v,r as x,k as E,P as O,c as l,j as e,F as T,K as C,m as Z,Q as J,R as ee,S as te,T as q,U as ne,V as se,W as re,X as oe,I as z,Y as ie,Z as L,v as ae,H as le,O as ce}from"./index-580067f6.js";import{B as Q,c as k}from"./Button-da95f22b.js";import{u as p,q as ue,B as de}from"./useKey-7aa77535.js";import{a as fe,b as me,d as pe,c as xe,B as ge,Q as he}from"./QuestionLoader-c245a33c.js";import{u as ye}from"./user.service-d59ec5e5.js";import{M as we}from"./Main-9760805c.js";import{E as Ne}from"./ErrMsg-d739357e.js";import"./index.esm-cba7d4dc.js";import"./Modal-b27688fc.js";import"./useOutsideClick-5ecc004f.js";const ve=()=>{const n=S(),t=j(),{language:r,questions:s}=v(),[u,h]=x.useState(!1),{loggedInUser:d}=E(),g=s.length;p("Enter",c),p("ArrowDown",w),p("ArrowUp",m);function c(){n(O("active"))}function m(){h(!1)}function w(){h(!0)}function f(){d&&t(`/profile/${d.id}`)}return l("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${r} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${g} question to test your ${r} mastery`}),g>0?e(Q,{onClickFn:c,className:k("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":u}),children:"Let's start"}):e(T,{children:d?l(T,{children:[e("p",{className:"mt-10 text-center text-2xl font-bold text-gray-50",children:"You have completed all the questions. Go to profile to reset the questions."}),e(Q,{onClickFn:f,className:"mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",children:"Go to Profile"})]}):e("p",{className:"mt-10 text-center text-2xl font-bold text-gray-50",children:"No questions available. Please try another language or level."})})]})},be=()=>{const{numQuestions:n,questionIdx:t,points:r,maxPossiblePoints:s,answerIdx:u}=v();return l("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(u!==null),max:n,className:"quiz-progress-bar col-span-full h-4 w-full"}),l("p",{children:["Question ",e("strong",{children:t+1}),"/",n]}),l("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:r}),"/",s]})]})},Qe=()=>{const n=S(),{questions:t,isTimerOn:r,secondsPerQuestion:s}=v(),[u,h]=x.useState(t.length*s),d=x.useRef(null),g=Math.floor(u/60),c=u%60;function m(){d.current&&clearInterval(d.current)}return x.useEffect(()=>(n(C(!0)),()=>{n(C(!1))}),[n]),x.useEffect(()=>{function w(){d.current=setInterval(()=>{h(f=>f===0?(n(O("finished")),f):f-1)},1e3)}return r?w():m(),()=>{m()}},[r,n]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:l("span",{children:[g<10&&"0",g,":",c<10&&"0",c]})})},Be=()=>{const n=S(),{isTimerOn:t}=v();function r(){n(C(!t))}const s=x.useRef(Z()).current;return l(T,{children:[e("button",{onClick:r,"data-tooltip-id":s,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(J,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(ee,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(ue,{id:s,style:{fontSize:"16px"},className:"hidden md:block"})]})},M=x.createContext(void 0);function ke({children:n}){const t=S(),r=te(),s=j(),{loggedInUser:u}=E(),{questions:h,questionIdx:d,numQuestions:g,answerIdx:c,points:m,highScore:w,isTimerOn:f}=v(),[o,N]=x.useState(""),b=r.pathname.includes("question-edit"),i=h[d],y=u==null?void 0:u.roles.includes("admin"),$=c!==null,P=d===g-1;p("Enter",W,{},[o]),p("ArrowRight",H,{},[o]),p("ArrowLeft",D,{},[o]),p("ArrowUp",U,{},[c,o]),p("ArrowDown",Y,{},[c,o]),p("e",V,{},[i==null?void 0:i.id,y,b]),p("a",_,{},[y,i==null?void 0:i.isRevised]),p("m",G,{},[y,i==null?void 0:i.isMarkedToBeRevised]),p("t",K,{},[f]);function H(){N("next")}function D(){N("quit")}function U(){if(!i||c)return;let a="";const B=i.options.length;if(o==="")a="option-1";else if(o.includes("option")){const A=Number(o.split("-")[1]);A===1?a=`option-${B}`:a=`option-${A-1}`}else o?a=`option-${B+1}`:a="option-1";N(a)}function Y(){if(!i||c)return;let a="";const B=i.options.length;if(o.includes("option")){const A=Number(o.split("-")[1]);A===B?a="option-1":a=`option-${A+1}`}else a="option-1";N(a)}function W(){if(o==="next")R();else if(o==="quit")F();else if(o.includes("option")){const a=Number(o.split("-")[1]);I(a-1)}N("")}function F(){t(q())}function I(a){t(ne(a)),i.correctOption===a&&(t(se(i.points)),u&&ye.recordUserCorrectAnswer(i))}function R(){if(c===null)return;d>=0&&d<g-1?t(re()):P&&(t(O("finished")),m>w&&t(oe(m)))}function K(){t(C(!f))}function V(){!y||b||(t(C(!1)),s(`question-edit/${i.id}`))}function _(){if(!y)return;const a={...i,isRevised:!i.isRevised};t(z(a,"approve"))}function G(){if(!y)return;const a={...i,isMarkedToBeRevised:!i.isMarkedToBeRevised};t(z(a,"mark"))}x.useEffect(()=>{function a(){o!==""&&N("")}return document.addEventListener("mousemove",a),()=>{document.removeEventListener("mousemove",a)}},[o]);const X={focusedBtn:o,question:i,isNextBtnShown:$,isLastQuestionIdx:P,onPassQuestion:R,handleQuitClick:F,onOptionSelection:I};return e(M.Provider,{value:X,children:n})}function Se(){const n=x.useContext(M);if(n===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return n}const Ae=()=>{const{loggedInUser:n}=E(),t=n==null?void 0:n.roles.includes("admin"),{focusedBtn:r,question:s,isNextBtnShown:u,isLastQuestionIdx:h,onPassQuestion:d,handleQuitClick:g,onOptionSelection:c}=Se(),{answerIdx:m}=v();return s?l("section",{className:"w-full max-w-[575px] px-14",children:[e(be,{}),l("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:s.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:s.options.map((w,f)=>{const o=m!==null,N=m===f,b=o&&s.correctOption===f;return e(Q,{className:k("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":N,correct:b,wrong:o&&!b,"translate-x-5 !bg-gray-800 text-gray-200":r===`option-${f+1}`,"!cursor-not-allowed":m!==null}),onClickFn:()=>c(f),disabled:o,children:w},f)})})]}),l(ie,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(Qe,{}),u&&e(Q,{onClickFn:d,className:k("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":r==="next"}),children:e("span",{children:h?"Finish":"Next"})}),e(Q,{onClickFn:g,className:k("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":r==="quit"}),children:e("span",{children:"Quit"})}),t&&l("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(Be,{}),e(de,{question:s}),e(fe,{question:s}),e(me,{question:s}),e(pe,{question:s}),e(xe,{questionId:s.id}),e(ge,{question:s,isToggled:!0})]})]})]}):null},Te=()=>{const{questions:n,answers:t}=v();return l("div",{className:"flex h-full w-full flex-col items-center space-y-4 rounded-lg bg-gray-100 p-4",children:[e("h1",{className:"w-full text-center text-4xl font-bold text-gray-800",children:"Quiz Summary"}),e("ul",{className:"w-full flex flex-col items-start gap-4",children:n.map((r,s)=>l("li",{className:"quiz-summary flex w-full flex-col items-start space-y-2",children:[l("p",{className:"text-2xl font-semibold text-gray-800 break-words",children:[s+1,". ",r.question]}),r.correctOption===t[s]?l("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",r.options[t[s]]]}):l(T,{children:[l("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Correct Answer: ",r.options[r.correctOption]]}),l("p",{className:"wrong-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",r.options[t[s]]]})]})]},r.id))})]})},Ce=()=>{const n=S(),{language:t,level:r,page:s,points:u,maxPossiblePoints:h,highScore:d,numQuestions:g}=v(),c=u/h*100,[m,w]=x.useState("none"),f=x.useRef("none");let o;c===100?o="ðŸ¥³":c>=80?o="ðŸ˜Ž":c>=60?o="ðŸ™‚":o="ðŸ˜ž";function N(){n(L({language:t,level:r,page:s+1,limit:g}))}function b(){n(q())}p("ArrowRight",()=>{w(y=>"restart")}),p("ArrowLeft",()=>{w(y=>"newQuiz")}),p("Enter",()=>{const y=f.current;y==="newQuiz"?N():y==="restart"&&b()});function i(){w(y=>"none")}return x.useEffect(()=>(document.addEventListener("mousemove",i),()=>{document.removeEventListener("mousemove",i)}),[]),x.useEffect(()=>{f.current=m},[m]),l("section",{className:"flex flex-col items-center gap-12 px-4",children:[l("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:o}),"You scored ",e("strong",{children:u})," out of"," ",e("strong",{children:h})," points. (",Math.ceil(c),"%)"]}),l("p",{className:"text-center text-3xl",children:["(Highscore: ",d," points)"]}),l("div",{className:"flex items-center justify-center gap-5",children:[e(Q,{className:k("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":m==="newQuiz"}),onClickFn:N,children:"Start New Quiz"}),e(Q,{className:k("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":m==="restart"}),onClickFn:b,children:"Restart"})]}),e(Te,{})]})},Ee=()=>{const{language:n}=v(),t=ae.programmingLanguages[n];if(!t)return null;const{img:r}=t;return l(le,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:r,alt:"logo",className:"h-20 w-20 object-contain"})]})},$e=()=>{const n=S(),{status:t,language:r,level:s,page:u,secondsPerQuestion:h,questions:d}=v();function g(c){switch(c){case"loading":return e(he,{});case"error":return e(Ne,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(ve,{});case"active":return e(ke,{children:e(Ae,{})});case"finished":return e(Ce,{});default:return e(T,{})}}return x.useEffect(()=>{d.length||n(L({language:r,level:s,page:u,secondsPerQuestion:h}))},[n]),l(we,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(Ee,{}),g(t),e(ce,{})]})};export{$e as default};
