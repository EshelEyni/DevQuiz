import{b as k,t as N,c as m,j as t,v as F,w as O,r as f,x as T,y as L,s as C,a as M,z as R,d as S,A as P,B as H,C as j,D as z,H as q,O as D,F as U,L as $}from"./index-583c7abd.js";import{B as Q,c as I}from"./Button-5200c168.js";import{u as E,c as K,e as W,d as _}from"./BtnMarkQuesitonToEdit-bf42fb2a.js";import{u as V}from"./user.service-857324b5.js";import{s as Y}from"./config-bc6444f8.js";import{E as G}from"./ErrMsg-c0307eae.js";import"./react-tooltip.min-d29c518d.js";const J=()=>{const e=k(),{language:s,numQuestions:n}=N();E("Enter",i);function i(){e(F("active"))}return m("div",{className:"flex flex-1 flex-col items-center justify-center gap-3 px-3",children:[t("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${s} Quiz!`}),t("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${n} question to test your ${s} mastery`}),t(Q,{onClickFn:i,className:"mt-10 rounded-full !bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100",children:"Let's start"})]})},X=({option:e,optionIdx:s,correctOption:n,handleOptionClick:i,isFocused:r})=>{const{answerIdx:u}=N(),a=u!==null,c=u===s,l=a&&n===s;return t(Q,{className:I("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":c,correct:l,wrong:a&&!l,"translate-x-5 !bg-gray-800":r,"!cursor-not-allowed":a}),onClickFn:()=>i(s),disabled:a,children:e})};function B(e){return{currIdx:0,arr:new Array(e).fill(!1),lastIdx:e-1}}const Z=({question:e})=>{const s=k(),{loggedInUser:n}=O(),[i,r]=f.useState(B(e.options.length)),[u,a]=f.useState(!1),[c,l]=f.useState(!1);function p(d){w(d)}const w=f.useCallback(d=>{a(!0),s(T(d)),e.correctOption===d&&(s(L(e.points)),n&&V.recordUserCorrectAnswer(e))},[s,n,e]);function o(){r(d=>{const x=new Array(d.arr.length).fill(!1);return{...d,arr:x}})}return f.useEffect(()=>{function d(){u||(l(!1),r(g=>{const v=new Array(g.arr.length).fill(!1);let h=g.currIdx-1;return h<0&&(h=g.lastIdx),v[h]=!0,{...g,arr:v,currIdx:h}}))}function x(){u||(l(!1),r(g=>{const v=new Array(g.arr.length).fill(!1),h=(g.currIdx+1)%v.length;return v[h]=!0,{...g,arr:v,currIdx:h}}))}function b(){c||(l(!0),o())}function y(){o(),w(i.currIdx)}function A(g){switch(g.key){case"ArrowUp":d();break;case"ArrowDown":x();break;case"Enter":y();break}}return document.addEventListener("mousemove",b),window.addEventListener("keydown",A),()=>{document.removeEventListener("mousemove",b),window.removeEventListener("keydown",A)}},[i,w,c,u]),f.useEffect(()=>{a(!1),l(!1),r(B(e.options.length))},[e]),t("div",{className:"mb-4 flex flex-col gap-4",children:e.options.map((d,x)=>t(X,{isFocused:i.arr[x],option:d,optionIdx:x,correctOption:e.correctOption,handleOptionClick:p},x))})},ee=()=>{const{numQuestions:e,questionIdx:s,points:n,maxPossiblePoints:i,answerIdx:r}=N();return m("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[t("progress",{value:s+ +(r!==null),max:e,className:"quiz-progress-bar col-span-full h-4 w-full"}),m("p",{children:["Question ",t("strong",{children:s+1}),"/",e]}),m("p",{className:"justify-self-end text-end",children:["Points ",t("strong",{children:n}),"/",i]})]})},te=()=>{const e=k(),{questions:s,isTimerOn:n,secondsPerQuestion:i}=N(),[r,u]=f.useState(s.length*i),a=f.useRef(null),c=Math.floor(r/60),l=r%60;function p(){a.current&&clearInterval(a.current)}return f.useEffect(()=>(e(C(!0)),()=>{e(C(!1))}),[e]),f.useEffect(()=>{function w(){a.current=setInterval(()=>{u(o=>o===0?o:o-1)},1e3)}return n?w():p(),()=>{p()}},[n,e]),t("div",{className:"col-start-1 row-start-1 flex h-20 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-500 px-8 text-3xl text-gray-200",children:m("span",{children:[c<10&&"0",c,":",l<10&&"0",l]})})},se=()=>{const e=k(),s=M(),{loggedInUser:n}=O(),{questions:i,questionIdx:r,numQuestions:u,answerIdx:a,points:c,highScore:l}=N(),p=a!==null,w=r===u-1;E("Enter",g);const o=i[r],d=n==null?void 0:n.roles.includes("admin"),x=o.isMarkedToBeRevised??!1;function b(){e(C(!1));const{id:h}=o;s(`question-edit/${h}`)}function y(){const h={...o,isRevised:!0};e(S(h))}function A(){const h={...o,isMarkedToBeRevised:!x};e(S(h))}function g(){r>=0&&r<u-1?e(P()):w&&(e(F("finished")),c>l&&e(H(c)))}function v(){e(j())}return m("section",{className:"max-w-[575px] px-14",children:[t(ee,{}),m("div",{children:[t("div",{className:"question-header",children:t("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:o.question})}),t(Z,{question:o})]}),m(R,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[t(te,{}),p&&t(Q,{onClickFn:g,className:"col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-500 px-7 text-3xl normal-case text-gray-200 transition-all hover:scale-105",children:t("span",{children:w?"Finish":"Next"})}),t(Q,{onClickFn:v,className:"col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-500 px-7 text-3xl normal-case text-gray-200 transition-all hover:scale-105",children:t("span",{children:"Quit"})}),d&&m("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[t(K,{isMarkedToBeRevised:x,handleBtnMarkToEditClick:A,size:26}),t(W,{handleBtnApproveClick:y,size:26}),t(_,{handleBtnEditClick:b,size:26})]})]})]})},ne=()=>{const e=k(),{language:s,level:n,page:i,points:r,maxPossiblePoints:u,highScore:a}=N(),c=r/u*100,[l,p]=f.useState("none"),w=f.useRef("none");let o;c===100?o="ðŸ¥³":c>=80?o="ðŸ˜Ž":c>=60?o="ðŸ™‚":o="ðŸ˜ž";function d(){e(z({language:s,level:n,page:i+1}))}function x(){e(j())}E("ArrowRight",()=>{p(y=>"restart")}),E("ArrowLeft",()=>{p(y=>"newQuiz")}),E("Enter",()=>{const y=w.current;y==="newQuiz"?d():y==="restart"&&x()});function b(){p(y=>"none")}return f.useEffect(()=>(document.addEventListener("mousemove",b),()=>{document.removeEventListener("mousemove",b)}),[]),f.useEffect(()=>{w.current=l},[l]),m("section",{className:"flex flex-col items-center gap-12 px-4",children:[m("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[t("span",{className:"mr-[4px] text-4xl",children:o}),"You scored ",t("strong",{children:r})," out of"," ",t("strong",{children:u})," points. (",Math.ceil(c),"%)"]}),m("p",{className:"text-center text-3xl",children:["(Highscore: ",a," points)"]}),m("div",{className:"flex items-center justify-center gap-5",children:[t(Q,{className:I("cursor-pointer rounded-full bg-gray-500 px-10 py-7 text-3xl transition-all duration-300",{"bg-gray-800":l==="newQuiz"}),onClickFn:d,children:"Start New Quiz"}),t(Q,{className:I("cursor-pointer rounded-full bg-gray-500 px-10 py-7 text-3xl transition-all duration-300",{"bg-gray-800":l==="restart"}),onClickFn:x,children:"Restart"})]})]})},re=()=>{const{language:e}=N(),s=Y.programmingLanguages[e];if(!s)return null;const{img:n}=s;return m(q,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[t("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),t("img",{src:n,alt:"logo",className:"h-20 w-20 object-contain"})]})},oe=({children:e})=>t("main",{className:"main",children:e}),xe=()=>{const e=k(),{status:s,language:n,level:i,page:r,questions:u}=N();function a(c){switch(c){case"loading":return t($,{title:"Loading questions..."});case"error":return t(G,{msg:"There was an error fetching questions. Please try again later."});case"ready":return t(J,{});case"active":return t(se,{});case"finished":return t(ne,{});default:return t(U,{})}}return f.useEffect(()=>{u.length>0||e(z({language:n,level:i,page:r}))},[]),m("div",{children:[t(re,{}),t(oe,{children:a(s)}),t(D,{})]})};export{xe as default};
