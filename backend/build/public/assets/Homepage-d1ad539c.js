import{b as E,o as b,c as f,j as t,p as S,t as O,r as d,v as z,w as M,s as I,a as R,x as L,d as B,y as P,z as H,A as j,B as T,H as q,O as D,F as U}from"./index-1f2d8112.js";import{B as k,c as C}from"./Button-6f10587e.js";import{u as A,a as $,c as K,b as W,Q as _}from"./BtnMarkQuesitonToEdit-e38c6c6a.js";import{u as V}from"./user.service-cf7c70a2.js";import{s as Y}from"./config-bc6444f8.js";import{E as G}from"./ErrMsg-e2ed7b40.js";import"./react-tooltip.min-84a1ff5c.js";const J=()=>{const e=E(),{language:s,numQuestions:n}=b();A("Enter",i);function i(){e(S("active"))}return f("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[t("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${s} Quiz!`}),t("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${n} question to test your ${s} mastery`}),t(k,{onClickFn:i,className:"mt-10 rounded-full !bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100",children:"Let's start"})]})},X=({option:e,optionIdx:s,correctOption:n,handleOptionClick:i,isFocused:r})=>{const{answerIdx:u}=b(),a=u!==null,m=u===s,c=a&&n===s;return t(k,{className:C("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":m,correct:c,wrong:a&&!c,"translate-x-5 !bg-gray-800":r,"!cursor-not-allowed":a}),onClickFn:()=>i(s),disabled:a,children:e})};function F(e){return{currIdx:0,arr:new Array(e).fill(!1),lastIdx:e-1}}const Z=({question:e})=>{const s=E(),{loggedInUser:n}=O(),[i,r]=d.useState(F(e.options.length)),[u,a]=d.useState(!1),[m,c]=d.useState(!1);function g(o){w(o)}const w=d.useCallback(o=>{a(!0),s(z(o)),e.correctOption===o&&(s(M(e.points)),n&&V.recordUserCorrectAnswer(e))},[s,n,e]);function l(){r(o=>{const x=new Array(o.arr.length).fill(!1);return{...o,arr:x}})}return d.useEffect(()=>{function o(){u||(c(!1),r(p=>{const v=new Array(p.arr.length).fill(!1);let h=p.currIdx-1;return h<0&&(h=p.lastIdx),v[h]=!0,{...p,arr:v,currIdx:h}}))}function x(){u||(c(!1),r(p=>{const v=new Array(p.arr.length).fill(!1),h=(p.currIdx+1)%v.length;return v[h]=!0,{...p,arr:v,currIdx:h}}))}function N(){m||(c(!0),l())}function Q(){l(),w(i.currIdx)}function y(p){switch(p.key){case"ArrowUp":o();break;case"ArrowDown":x();break;case"Enter":Q();break}}return document.addEventListener("mousemove",N),window.addEventListener("keydown",y),()=>{document.removeEventListener("mousemove",N),window.removeEventListener("keydown",y)}},[i,w,m,u]),d.useEffect(()=>{a(!1),c(!1),r(F(e.options.length))},[e]),t("div",{className:"mb-4 flex flex-col gap-4",children:e.options.map((o,x)=>t(X,{isFocused:i.arr[x],option:o,optionIdx:x,correctOption:e.correctOption,handleOptionClick:g},x))})},ee=()=>{const{numQuestions:e,questionIdx:s,points:n,maxPossiblePoints:i,answerIdx:r}=b();return f("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[t("progress",{value:s+ +(r!==null),max:e,className:"quiz-progress-bar col-span-full h-4 w-full"}),f("p",{children:["Question ",t("strong",{children:s+1}),"/",e]}),f("p",{className:"justify-self-end text-end",children:["Points ",t("strong",{children:n}),"/",i]})]})},te=()=>{const e=E(),{questions:s,isTimerOn:n,secondsPerQuestion:i}=b(),[r,u]=d.useState(s.length*i),a=d.useRef(null),m=Math.floor(r/60),c=r%60;function g(){a.current&&clearInterval(a.current)}return d.useEffect(()=>(e(I(!0)),()=>{e(I(!1))}),[e]),d.useEffect(()=>{function w(){a.current=setInterval(()=>{u(l=>l===0?(e(S("finished")),l):l-1)},1e3)}return n?w():g(),()=>{g()}},[n,e]),t("div",{className:"col-start-1 row-start-1 flex h-20 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:f("span",{children:[m<10&&"0",m,":",c<10&&"0",c]})})},se=()=>{const e=E(),s=R(),{loggedInUser:n}=O(),{questions:i,questionIdx:r,numQuestions:u,answerIdx:a,points:m,highScore:c}=b(),g=a!==null,w=r===u-1;A("Enter",p);const l=i[r],o=n==null?void 0:n.roles.includes("admin"),x=l.isMarkedToBeRevised??!1;function N(){e(I(!1));const{id:h}=l;s(`question-edit/${h}`)}function Q(){const h={...l,isRevised:!0};e(B(h))}function y(){const h={...l,isMarkedToBeRevised:!x};e(B(h))}function p(){r>=0&&r<u-1?e(P()):w&&(e(S("finished")),m>c&&e(H(m)))}function v(){e(j())}return f("section",{className:"w-full max-w-[575px] px-14",children:[t(ee,{}),f("div",{children:[t("div",{className:"question-header",children:t("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:l.question})}),t(Z,{question:l})]}),f(L,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[t(te,{}),g&&t(k,{onClickFn:p,className:"col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full border-2 border-gray-200 px-7 text-3xl normal-case text-gray-200 transition-all hover:scale-105",children:t("span",{children:w?"Finish":"Next"})}),t(k,{onClickFn:v,className:"col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full border-2 border-gray-200 px-7 text-3xl normal-case text-gray-200 transition-all hover:scale-105",children:t("span",{children:"Quit"})}),o&&f("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[t($,{isMarkedToBeRevised:x,handleBtnMarkToEditClick:y}),t(K,{isApproved:l.isRevised,handleBtnApproveClick:Q}),t(W,{handleBtnEditClick:N})]})]})]})},ne=()=>{const e=E(),{language:s,level:n,page:i,points:r,maxPossiblePoints:u,highScore:a,numQuestions:m}=b(),c=r/u*100,[g,w]=d.useState("none"),l=d.useRef("none");let o;c===100?o="ðŸ¥³":c>=80?o="ðŸ˜Ž":c>=60?o="ðŸ™‚":o="ðŸ˜ž";function x(){e(T({language:s,level:n,page:i+1,limit:m}))}function N(){e(j())}A("ArrowRight",()=>{w(y=>"restart")}),A("ArrowLeft",()=>{w(y=>"newQuiz")}),A("Enter",()=>{const y=l.current;y==="newQuiz"?x():y==="restart"&&N()});function Q(){w(y=>"none")}return d.useEffect(()=>(document.addEventListener("mousemove",Q),()=>{document.removeEventListener("mousemove",Q)}),[]),d.useEffect(()=>{l.current=g},[g]),f("section",{className:"flex flex-col items-center gap-12 px-4",children:[f("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[t("span",{className:"mr-[4px] text-4xl",children:o}),"You scored ",t("strong",{children:r})," out of"," ",t("strong",{children:u})," points. (",Math.ceil(c),"%)"]}),f("p",{className:"text-center text-3xl",children:["(Highscore: ",a," points)"]}),f("div",{className:"flex items-center justify-center gap-5",children:[t(k,{className:C("cursor-pointer rounded-full border-2 border-gray-200 px-10 py-7 text-3xl transition-all duration-300",{"bg-gray-800":g==="newQuiz"}),onClickFn:x,children:"Start New Quiz"}),t(k,{className:C("cursor-pointer rounded-full border-2 border-gray-200 px-10 py-7 text-3xl transition-all duration-300",{"bg-gray-800":g==="restart"}),onClickFn:N,children:"Restart"})]})]})},re=()=>{const{language:e}=b(),s=Y.programmingLanguages[e];if(!s)return null;const{img:n}=s;return f(q,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[t("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),t("img",{src:n,alt:"logo",className:"h-20 w-20 object-contain"})]})},oe=({children:e,className:s})=>t("main",{className:s,children:e}),xe=()=>{const e=E(),{status:s,language:n,level:i,page:r,questions:u}=b();function a(m){switch(m){case"loading":return t(_,{});case"error":return t(G,{msg:"There was an error fetching questions. Please try again later."});case"ready":return t(J,{});case"active":return t(se,{});case"finished":return t(ne,{});default:return t(U,{})}}return d.useEffect(()=>{u.length>0||e(T({language:n,level:i,page:r}))},[]),f(oe,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[t(re,{}),a(s),t(D,{})]})};export{xe as default};
