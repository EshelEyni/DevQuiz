import{b as k,o as v,r as x,p as C,c as f,j as e,s as T,m as Y,F as R,M as G,t as J,a as X,v as j,w as I,x as Z,y as ee,z as te,A as ne,d as F,B as se,C as z,H as re,O as ie}from"./index-123cc4bb.js";import{B as b,c as B}from"./Button-a2161a7a.js";import{u as m,q as oe}from"./useKey-4ca69785.js";import{a as ae,c as ce,b as le,B as ue,Q as de}from"./BtnMarkQuesitonToEdit-e98f99b8.js";import{u as fe}from"./user.service-5e305424.js";import{s as me}from"./config-5ddf0168.js";import{E as xe}from"./ErrMsg-9795dfec.js";import"./Modal-e5388d83.js";import"./useOutsideClick-a1f9a642.js";const pe=()=>{const s=k(),{language:t,numQuestions:o}=v(),[r,l]=x.useState(!1);m("Enter",u),m("ArrowDown",c),m("ArrowUp",p);function u(){s(C("active"))}function p(){l(!1)}function c(){l(!0)}return f("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${t} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${o} question to test your ${t} mastery`}),e(b,{onClickFn:u,className:B("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":r}),children:"Let's start"})]})},ge=()=>{const{numQuestions:s,questionIdx:t,points:o,maxPossiblePoints:r,answerIdx:l}=v();return f("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(l!==null),max:s,className:"quiz-progress-bar col-span-full h-4 w-full"}),f("p",{children:["Question ",e("strong",{children:t+1}),"/",s]}),f("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:o}),"/",r]})]})},he=()=>{const s=k(),{questions:t,isTimerOn:o,secondsPerQuestion:r}=v(),[l,u]=x.useState(t.length*r),p=x.useRef(null),c=Math.floor(l/60),h=l%60;function g(){p.current&&clearInterval(p.current)}return x.useEffect(()=>(s(T(!0)),()=>{s(T(!1))}),[s]),x.useEffect(()=>{function y(){p.current=setInterval(()=>{u(n=>n===0?(s(C("finished")),n):n-1)},1e3)}return o?y():g(),()=>{g()}},[o,s]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:f("span",{children:[c<10&&"0",c,":",h<10&&"0",h]})})},we=()=>{const s=k(),{isTimerOn:t}=v();function o(){s(T(!t))}const r=x.useRef(Y()).current;return f(R,{children:[e("button",{onClick:o,"data-tooltip-id":r,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(G,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(J,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(oe,{id:r,style:{fontSize:"16px"},className:"hidden md:block"})]})},M=x.createContext(void 0);function ye({children:s}){const t=k(),o=X(),{loggedInUser:r}=j(),{questions:l,questionIdx:u,numQuestions:p,answerIdx:c,points:h,highScore:g,isTimerOn:y}=v(),[n,d]=x.useState(""),a=l[u],w=r==null?void 0:r.roles.includes("admin"),A=c!==null,N=u===p-1;m("Enter",D,{},[n]),m("ArrowRight",P,{},[n]),m("ArrowLeft",L,{},[n]),m("ArrowUp",$,{},[c,n]),m("ArrowDown",H,{},[c,n]),m("e",W,{},[a.id,w]),m("a",_,{},[w,a.isRevised]),m("m",K,{},[w,a.isMarkedToBeRevised]),m("t",U,{},[y]);function P(){d("next")}function L(){d("quit")}function $(){if(c)return;let i="";const Q=a.options.length;if(n==="")i="option-1";else if(n.includes("option")){const S=Number(n.split("-")[1]);S===1?i=`option-${Q+1}`:i=`option-${S-1}`}else n?i=`option-${Q+1}`:i="option-1";d(i)}function H(){if(c)return;let i="";const Q=a.options.length;if(n.includes("option")){const S=Number(n.split("-")[1]);S===Q+1?i="option-1":i=`option-${S+1}`}else i="option-1";d(i)}function D(){if(n==="next")O();else if(n==="quit")E();else if(n.includes("option")){const i=Number(n.split("-")[1]);q(i-1)}d("")}function E(){t(I())}function q(i){t(Z(i)),a.correctOption===i&&(t(ee(a.points)),r&&fe.recordUserCorrectAnswer(a))}function O(){if(c===null)return;u>=0&&u<p-1?t(te()):N&&(t(C("finished")),h>g&&t(ne(h)))}function U(){t(T(!y))}function W(){w&&(t(T(!1)),o(`question-edit/${a.id}`))}function _(){if(!w)return;const i={...a,isRevised:!a.isRevised};t(F(i,"approve"))}function K(){if(!w)return;const i={...a,isMarkedToBeRevised:!a.isMarkedToBeRevised};t(F(i,"mark"))}x.useEffect(()=>{function i(){n!==""&&d("")}return document.addEventListener("mousemove",i),()=>{document.removeEventListener("mousemove",i)}},[n]);const V={focusedBtn:n,question:a,isNextBtnShown:A,isLastQuestionIdx:N,onPassQuestion:O,handleQuitClick:E,onOptionSelection:q};return e(M.Provider,{value:V,children:s})}function ve(){const s=x.useContext(M);if(s===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return s}const Ne=()=>{const{loggedInUser:s}=j(),t=s==null?void 0:s.roles.includes("admin"),{focusedBtn:o,question:r,isNextBtnShown:l,isLastQuestionIdx:u,onPassQuestion:p,handleQuitClick:c,onOptionSelection:h}=ve(),{answerIdx:g}=v();return r?f("section",{className:"w-full max-w-[575px] px-14",children:[e(ge,{}),f("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:r.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:r.options.map((y,n)=>{const d=g!==null,a=g===n,w=d&&r.correctOption===n;return e(b,{className:B("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":a,correct:w,wrong:d&&!w,"translate-x-5 !bg-gray-800 text-gray-200":o===`option-${n+1}`,"!cursor-not-allowed":g!==null}),onClickFn:()=>h(n),disabled:d,children:y},n)})})]}),f(se,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(he,{}),l&&e(b,{onClickFn:p,className:B("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-4xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":o==="next"}),children:e("span",{children:u?"Finish":"Next"})}),e(b,{onClickFn:c,className:B("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-4xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":o==="quit"}),children:e("span",{children:"Quit"})}),t&&f("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(we,{}),e(ae,{question:r}),e(ce,{question:r}),e(le,{questionId:r.id}),e(ue,{question:r})]})]})]}):null},Qe=()=>{const s=k(),{language:t,level:o,page:r,points:l,maxPossiblePoints:u,highScore:p,numQuestions:c}=v(),h=l/u*100,[g,y]=x.useState("none"),n=x.useRef("none");let d;h===100?d="ðŸ¥³":h>=80?d="ðŸ˜Ž":h>=60?d="ðŸ™‚":d="ðŸ˜ž";function a(){s(z({language:t,level:o,page:r+1,limit:c}))}function w(){s(I())}m("ArrowRight",()=>{y(N=>"restart")}),m("ArrowLeft",()=>{y(N=>"newQuiz")}),m("Enter",()=>{const N=n.current;N==="newQuiz"?a():N==="restart"&&w()});function A(){y(N=>"none")}return x.useEffect(()=>(document.addEventListener("mousemove",A),()=>{document.removeEventListener("mousemove",A)}),[]),x.useEffect(()=>{n.current=g},[g]),f("section",{className:"flex flex-col items-center gap-12 px-4",children:[f("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:d}),"You scored ",e("strong",{children:l})," out of"," ",e("strong",{children:u})," points. (",Math.ceil(h),"%)"]}),f("p",{className:"text-center text-3xl",children:["(Highscore: ",p," points)"]}),f("div",{className:"flex items-center justify-center gap-5",children:[e(b,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":g==="newQuiz"}),onClickFn:a,children:"Start New Quiz"}),e(b,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":g==="restart"}),onClickFn:w,children:"Restart"})]})]})},be=()=>{const{language:s}=v(),t=me.programmingLanguages[s];if(!t)return null;const{img:o}=t;return f(re,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:o,alt:"logo",className:"h-20 w-20 object-contain"})]})},Be=({children:s,className:t})=>e("main",{className:t,children:s}),Re=()=>{const s=k(),{status:t,language:o,level:r,page:l,questions:u}=v();function p(c){switch(c){case"loading":return e(de,{});case"error":return e(xe,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(pe,{});case"active":return e(ye,{children:e(Ne,{})});case"finished":return e(Qe,{});default:return e(R,{})}}return x.useEffect(()=>{u.length>0||s(z({language:o,level:r,page:l}))},[]),f(Be,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(be,{}),p(t),e(ie,{})]})};export{Re as default};
