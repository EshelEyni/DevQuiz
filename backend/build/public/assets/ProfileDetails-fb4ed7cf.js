import{j as e,r as u,c as a,u as A,a as D,b as O,v as H,N as R,L as U,H as T,F as V,P as j,Q as $,S as W}from"./index-ed169895.js";import{B as v}from"./Button-87cb0513.js";import{u as C}from"./user.service-f1ee5120.js";import{s as G}from"./config-c3e48a03.js";import{S as w}from"./Select-f9b1dd4e.js";import{M as p}from"./Modal-f0ec1844.js";import{E as L}from"./ErrMsg-8775ee6e.js";import{u as J}from"./index.esm-4b7a71a8.js";import"./useOutsideClick-f4ca44bf.js";const K=({percentage:s,themeColor:n})=>{const c=`radial-gradient(closest-side,  rgb(71 85 99) 80%, transparent 81%),
  conic-gradient(${n} ${s>100?100:s}%, rgb(241 245 249) 0)`;return e("div",{className:"relative my-auto flex h-40 w-40 items-center justify-center",children:e("div",{className:"h-full w-full rounded-full",style:{background:c}})})};function k({answerCount:s,questionCount:n}){return s/n*100}const X=({answerLanguage:s,answerCount:n,questionCount:c,onRestart:l})=>{const[r,h]=u.useState("total"),[m,x]=u.useState(k({answerCount:n.total,questionCount:c.total})),{themeColor:y}=G.programmingLanguages[s].themeColors;function d(o){h(o),x(k({answerCount:n[o],questionCount:c[o]}))}async function N(){l({language:s,level:r==="total"?void 0:r})}return a("div",{className:"flex min-h-[26rem] w-72 flex-col items-center overflow-hidden rounded-md bg-gray-600 pt-4",children:[e(K,{percentage:m,themeColor:y}),a("h3",{className:"my-auto text-4xl font-medium md:text-3xl",children:[n[r],"/",c[r]]}),a(p,{children:[e(p.OpenBtn,{modalName:"restart",className:`my-auto flex h-12 w-44 \r
          cursor-pointer items-center justify-center rounded-xl border border-gray-800 bg-gray-700 text-2xl font-semibold capitalize leading-5 text-gray-100 outline-none transition-all duration-300`,children:e("span",{children:"restart"})}),a(p.Window,{name:"restart",className:"fixed left-1/2 top-1/2 z-[500] flex max-w-[320px] -translate-x-1/2 -translate-y-1/2 transform flex-col items-center rounded-lg bg-gray-600 p-8 text-gray-100 shadow-xl",children:[e("p",{className:"text-2xl font-semibold",children:"Are you sure you want to restart?"}),e("p",{className:"text-md mt-4 max-w-[200px] font-medium",children:"This will reset all your progress, and bring you questions you have already answered."}),a("div",{className:"mt-8 flex items-center gap-4",children:[e(p.CloseBtn,{className:"rounded-full bg-gray-800 px-5 py-3 text-lg font-medium uppercase",children:e("button",{children:"cancel"})}),e(p.CloseBtn,{className:"rounded-full bg-gray-800 px-5 py-3 text-lg font-medium uppercase",onClickFn:N,children:e("button",{children:"restart"})})]})]})]}),a(w,{onChange:d,children:[e(w.SelectTrigger,{className:`my-auto h-12 w-44 cursor-pointer rounded-xl \r
            border border-gray-800 bg-gray-700 text-2xl capitalize leading-5 outline-none transition-all duration-300`,children:e("button",{type:"button",children:r})}),e(w.SelectList,{className:`z-[1500] mt-1 w-44  min-w-[100px] cursor-pointer \r
            border-2  border-gray-800 bg-gray-700 text-2xl leading-5 outline-none transition-all duration-300`,children:Object.keys(n).map(o=>e(w.SelectItem,{value:o,className:`flex h-12 w-full min-w-[100px]  cursor-pointer items-center justify-center border-b-2 border-gray-800 bg-gray-700 text-2xl\r
                    text-gray-100 hover:border-gray-900 hover:bg-gray-950 hover:text-gray-100`,children:e("span",{className:"capitalize",children:o})},o))})]}),e("div",{className:"mt-auto flex h-14 w-full items-center justify-center bg-gray-900",children:e("span",{className:"text-[1.8rem] font-bold tracking-wide text-gray-100",children:s})})]})},le=()=>{const s=A(),n=D(),c=O(),{loggedInUser:l}=H(),[r,h]=u.useState(null),[m,x]=u.useState(!1),[y,d]=u.useState(R),N=y.state==="succeeded"&&r&&!m,o=y.state==="loading",{id:q}=s,b=l&&l.id===q,{register:E,handleSubmit:B,formState:{errors:S}}=J({});async function F(){try{d(i=>({...i,state:"loading"}));const t=await C.getUserStats();h(t),d(i=>({...i,state:"succeeded"}))}catch(t){const i=j(t);d(f=>({...f,state:"failed",error:i}))}}u.useEffect(()=>{!b||r||F()},[b,r]);function P(){c($()),n("/home")}function z(){x(t=>!t)}async function I({language:t,level:i}){try{d(g=>({...g,state:"loading"})),await C.removeUserCorrectAnswers({language:t,level:i});const f=await C.getUserStats();h(f),d(g=>({...g,state:"succeeded"}))}catch(f){const g=j(f);d(Q=>({...Q,state:"failed",error:g}))}}function M(t){l&&(c(W({...l,...t})),x(!1))}return a("main",{className:"flex min-h-[250px] w-screen flex-col items-center overflow-hidden p-2 pb-24",children:[!b&&e(U,{className:"mt-52"}),b&&a("div",{className:"mt-5 flex w-full flex-col items-center gap-6 md:w-3/5",children:[a(T,{className:"flex w-full flex-col gap-4",children:[e("h1",{className:"text-4xl font-semibold tracking-wider",children:l.username}),a("div",{className:"flex items-center gap-3 self-start",children:[e(v,{onClickFn:P,className:"text-md transform rounded-full bg-gray-800 p-3 font-semibold uppercase transition-all duration-300 ease-in-out hover:scale-105",children:"logout"}),e(v,{onClickFn:z,className:"text-md transform rounded-full bg-gray-800 p-3 font-semibold uppercase transition-all duration-300 ease-in-out hover:scale-105",children:m?"stats":"edit"})]})]}),m&&a("form",{onSubmit:B(M),className:"mt-10 flex flex-col items-center gap-4 rounded-xl bg-gray-600 p-6",children:[e("input",{...E("username",{required:"Username is required"}),placeholder:"Username",className:"text-md w-64 transform rounded-full bg-gray-800 p-3 font-semibold uppercase transition-all duration-300 ease-in-out hover:scale-105",defaultValue:l.username||""}),S.username&&e(L,{msg:S.username.message}),e("input",{...E("email",{required:"Email is required",pattern:{value:/\S+@\S+\.\S+/,message:"Entered value does not match email format"}}),placeholder:"Email",className:"text-md w-64 transform rounded-full bg-gray-800 p-3 font-semibold uppercase transition-all duration-300 ease-in-out hover:scale-105",defaultValue:l.email||""}),S.email&&e(L,{msg:S.email.message}),e(v,{type:"submit",className:"text-md mt-5 w-20 transform rounded-full bg-gray-800 p-3 font-semibold uppercase transition-all duration-300 ease-in-out hover:scale-105",children:"Save"})]}),a("ul",{className:"flex w-full flex-wrap justify-center gap-4 self-start",children:[o&&e(U,{className:"mt-10 self-center"}),N&&e(V,{children:Object.entries(r.answersCount).map(([t,i])=>e(X,{answerLanguage:t,answerCount:i,questionCount:r.questionsCount[t],onRestart:I},t))})]})]})]})};export{le as default};
