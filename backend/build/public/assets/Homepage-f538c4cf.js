import{b as k,m as v,r as p,n as C,c as f,j as e,s as T,o as Y,F as R,M as G,p as J,a as X,t as j,v as I,w as Z,x as ee,y as te,z as ne,d as F,A as se,B as z,H as re,O as oe}from"./index-b971d91e.js";import{B as b,c as B}from"./Button-645dc4f0.js";import{u as m,q as ie,B as ae}from"./useKey-5c3c29dc.js";import{a as ce,b as le,d as ue,c as de,B as fe,Q as me}from"./BtnShuffleOption-4cb94b57.js";import{u as pe}from"./user.service-545f6029.js";import{s as xe}from"./config-5ddf0168.js";import{E as ge}from"./ErrMsg-5d122f15.js";import"./Modal-c8cb7070.js";import"./useOutsideClick-a2ba1c86.js";const he=()=>{const s=k(),{language:t,numQuestions:i}=v(),[r,l]=p.useState(!1);m("Enter",u),m("ArrowDown",c),m("ArrowUp",x);function u(){s(C("active"))}function x(){l(!1)}function c(){l(!0)}return f("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${t} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${i} question to test your ${t} mastery`}),e(b,{onClickFn:u,className:B("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":r}),children:"Let's start"})]})},we=()=>{const{numQuestions:s,questionIdx:t,points:i,maxPossiblePoints:r,answerIdx:l}=v();return f("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(l!==null),max:s,className:"quiz-progress-bar col-span-full h-4 w-full"}),f("p",{children:["Question ",e("strong",{children:t+1}),"/",s]}),f("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:i}),"/",r]})]})},ye=()=>{const s=k(),{questions:t,isTimerOn:i,secondsPerQuestion:r}=v(),[l,u]=p.useState(t.length*r),x=p.useRef(null),c=Math.floor(l/60),h=l%60;function g(){x.current&&clearInterval(x.current)}return p.useEffect(()=>(s(T(!0)),()=>{s(T(!1))}),[s]),p.useEffect(()=>{function y(){x.current=setInterval(()=>{u(n=>n===0?(s(C("finished")),n):n-1)},1e3)}return i?y():g(),()=>{g()}},[i,s]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:f("span",{children:[c<10&&"0",c,":",h<10&&"0",h]})})},ve=()=>{const s=k(),{isTimerOn:t}=v();function i(){s(T(!t))}const r=p.useRef(Y()).current;return f(R,{children:[e("button",{onClick:i,"data-tooltip-id":r,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(G,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(J,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(ie,{id:r,style:{fontSize:"16px"},className:"hidden md:block"})]})},M=p.createContext(void 0);function Ne({children:s}){const t=k(),i=X(),{loggedInUser:r}=j(),{questions:l,questionIdx:u,numQuestions:x,answerIdx:c,points:h,highScore:g,isTimerOn:y}=v(),[n,d]=p.useState(""),a=l[u],w=r==null?void 0:r.roles.includes("admin"),A=c!==null,N=u===x-1;m("Enter",D,{},[n]),m("ArrowRight",P,{},[n]),m("ArrowLeft",L,{},[n]),m("ArrowUp",$,{},[c,n]),m("ArrowDown",H,{},[c,n]),m("e",W,{},[a.id,w]),m("a",_,{},[w,a.isRevised]),m("m",K,{},[w,a.isMarkedToBeRevised]),m("t",U,{},[y]);function P(){d("next")}function L(){d("quit")}function $(){if(c)return;let o="";const Q=a.options.length;if(n==="")o="option-1";else if(n.includes("option")){const S=Number(n.split("-")[1]);S===1?o=`option-${Q}`:o=`option-${S-1}`}else n?o=`option-${Q+1}`:o="option-1";d(o)}function H(){if(c)return;let o="";const Q=a.options.length;if(n.includes("option")){const S=Number(n.split("-")[1]);S===Q?o="option-1":o=`option-${S+1}`}else o="option-1";d(o)}function D(){if(n==="next")q();else if(n==="quit")E();else if(n.includes("option")){const o=Number(n.split("-")[1]);O(o-1)}d("")}function E(){t(I())}function O(o){t(Z(o)),a.correctOption===o&&(t(ee(a.points)),r&&pe.recordUserCorrectAnswer(a))}function q(){if(c===null)return;u>=0&&u<x-1?t(te()):N&&(t(C("finished")),h>g&&t(ne(h)))}function U(){t(T(!y))}function W(){w&&(t(T(!1)),i(`question-edit/${a.id}`))}function _(){if(!w)return;const o={...a,isRevised:!a.isRevised};t(F(o,"approve"))}function K(){if(!w)return;const o={...a,isMarkedToBeRevised:!a.isMarkedToBeRevised};t(F(o,"mark"))}p.useEffect(()=>{function o(){n!==""&&d("")}return document.addEventListener("mousemove",o),()=>{document.removeEventListener("mousemove",o)}},[n]);const V={focusedBtn:n,question:a,isNextBtnShown:A,isLastQuestionIdx:N,onPassQuestion:q,handleQuitClick:E,onOptionSelection:O};return e(M.Provider,{value:V,children:s})}function Qe(){const s=p.useContext(M);if(s===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return s}const be=()=>{const{loggedInUser:s}=j(),t=s==null?void 0:s.roles.includes("admin"),{focusedBtn:i,question:r,isNextBtnShown:l,isLastQuestionIdx:u,onPassQuestion:x,handleQuitClick:c,onOptionSelection:h}=Qe(),{answerIdx:g}=v();return r?f("section",{className:"w-full max-w-[575px] px-14",children:[e(we,{}),f("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:r.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:r.options.map((y,n)=>{const d=g!==null,a=g===n,w=d&&r.correctOption===n;return e(b,{className:B("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":a,correct:w,wrong:d&&!w,"translate-x-5 !bg-gray-800 text-gray-200":i===`option-${n+1}`,"!cursor-not-allowed":g!==null}),onClickFn:()=>h(n),disabled:d,children:y},n)})})]}),f(se,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(ye,{}),l&&e(b,{onClickFn:x,className:B("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":i==="next"}),children:e("span",{children:u?"Finish":"Next"})}),e(b,{onClickFn:c,className:B("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":i==="quit"}),children:e("span",{children:"Quit"})}),t&&f("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(ve,{}),e(ae,{question:r}),e(ce,{question:r}),e(le,{question:r}),e(ue,{question:r}),e(de,{questionId:r.id}),e(fe,{question:r})]})]})]}):null},Be=()=>{const s=k(),{language:t,level:i,page:r,points:l,maxPossiblePoints:u,highScore:x,numQuestions:c}=v(),h=l/u*100,[g,y]=p.useState("none"),n=p.useRef("none");let d;h===100?d="ðŸ¥³":h>=80?d="ðŸ˜Ž":h>=60?d="ðŸ™‚":d="ðŸ˜ž";function a(){s(z({language:t,level:i,page:r+1,limit:c}))}function w(){s(I())}m("ArrowRight",()=>{y(N=>"restart")}),m("ArrowLeft",()=>{y(N=>"newQuiz")}),m("Enter",()=>{const N=n.current;N==="newQuiz"?a():N==="restart"&&w()});function A(){y(N=>"none")}return p.useEffect(()=>(document.addEventListener("mousemove",A),()=>{document.removeEventListener("mousemove",A)}),[]),p.useEffect(()=>{n.current=g},[g]),f("section",{className:"flex flex-col items-center gap-12 px-4",children:[f("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:d}),"You scored ",e("strong",{children:l})," out of"," ",e("strong",{children:u})," points. (",Math.ceil(h),"%)"]}),f("p",{className:"text-center text-3xl",children:["(Highscore: ",x," points)"]}),f("div",{className:"flex items-center justify-center gap-5",children:[e(b,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":g==="newQuiz"}),onClickFn:a,children:"Start New Quiz"}),e(b,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":g==="restart"}),onClickFn:w,children:"Restart"})]})]})},ke=()=>{const{language:s}=v(),t=xe.programmingLanguages[s];if(!t)return null;const{img:i}=t;return f(re,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:i,alt:"logo",className:"h-20 w-20 object-contain"})]})},Ae=({children:s,className:t})=>e("main",{className:t,children:s}),Ie=()=>{const s=k(),{status:t,language:i,level:r,page:l,questions:u}=v();function x(c){switch(c){case"loading":return e(me,{});case"error":return e(ge,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(he,{});case"active":return e(Ne,{children:e(be,{})});case"finished":return e(Be,{});default:return e(R,{})}}return p.useEffect(()=>{u.length>0||s(z({language:i,level:r,page:l}))},[]),f(Ae,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(ke,{}),x(t),e(oe,{})]})};export{Ie as default};
