import{u as A,q as R,y as N,r as h,b as T,z as q,a as l,j as e,F as E,w as C,A as V,M as J,B as X,C as j,D as Z,E as ee,I as te,J as ne,t as P,K as se,N as O,s as re,H as oe,O as ie}from"./index-e1173b8c.js";import{B as Q,c as B}from"./Button-3da8f0c2.js";import{u as g,q as le,B as ae}from"./useKey-ae3fdda1.js";import{a as ce,b as ue,d as de,c as fe,B as me,Q as pe}from"./QuestionLoader-f4eb81bb.js";import{u as xe}from"./user.service-da40b9b7.js";import{E as ge}from"./ErrMsg-5af806eb.js";import"./Modal-c3e39ad5.js";import"./useOutsideClick-b638521a.js";const he=()=>{const s=A(),t=R(),{language:o,numQuestions:n}=N(),[p,f]=h.useState(!1),{loggedInUser:x}=T();g("Enter",u),g("ArrowDown",m),g("ArrowUp",a);function u(){s(q("active"))}function a(){f(!1)}function m(){f(!0)}function w(){x&&t(`/profile/${x.id}`)}return l("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${o} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${n} question to test your ${o} mastery`}),n>0?e(Q,{onClickFn:u,className:B("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":p}),children:"Let's start"}):l(E,{children:[e("p",{className:"mt-10 text-center text-2xl font-bold text-gray-50",children:"You have completed all the questions. Go to profile to reset the questions."}),e(Q,{onClickFn:w,className:"mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",children:"Go to Profile"})]})]})},we=()=>{const{numQuestions:s,questionIdx:t,points:o,maxPossiblePoints:n,answerIdx:p}=N();return l("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(p!==null),max:s,className:"quiz-progress-bar col-span-full h-4 w-full"}),l("p",{children:["Question ",e("strong",{children:t+1}),"/",s]}),l("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:o}),"/",n]})]})},ye=()=>{const s=A(),{questions:t,isTimerOn:o,secondsPerQuestion:n}=N(),[p,f]=h.useState(t.length*n),x=h.useRef(null),u=Math.floor(p/60),a=p%60;function m(){x.current&&clearInterval(x.current)}return h.useEffect(()=>(s(C(!0)),()=>{s(C(!1))}),[s]),h.useEffect(()=>{function w(){x.current=setInterval(()=>{f(r=>r===0?(s(q("finished")),r):r-1)},1e3)}return o?w():m(),()=>{m()}},[o,s]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:l("span",{children:[u<10&&"0",u,":",a<10&&"0",a]})})},Ne=()=>{const s=A(),{isTimerOn:t}=N();function o(){s(C(!t))}const n=h.useRef(V()).current;return l(E,{children:[e("button",{onClick:o,"data-tooltip-id":n,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(J,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(X,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(le,{id:n,style:{fontSize:"16px"},className:"hidden md:block"})]})},M=h.createContext(void 0);function ve({children:s}){const t=A(),o=R(),{loggedInUser:n}=T(),{questions:p,questionIdx:f,numQuestions:x,answerIdx:u,points:a,highScore:m,isTimerOn:w}=N(),[r,d]=h.useState(""),c=p[f],y=n==null?void 0:n.roles.includes("admin"),S=u!==null,v=f===x-1;g("Enter",U,{},[r]),g("ArrowRight",L,{},[r]),g("ArrowLeft",$,{},[r]),g("ArrowUp",H,{},[u,r]),g("ArrowDown",D,{},[u,r]),g("e",K,{},[c.id,y]),g("a",W,{},[y,c.isRevised]),g("m",_,{},[y,c.isMarkedToBeRevised]),g("t",Y,{},[w]);function L(){d("next")}function $(){d("quit")}function H(){if(u)return;let i="";const b=c.options.length;if(r==="")i="option-1";else if(r.includes("option")){const k=Number(r.split("-")[1]);k===1?i=`option-${b}`:i=`option-${k-1}`}else r?i=`option-${b+1}`:i="option-1";d(i)}function D(){if(u)return;let i="";const b=c.options.length;if(r.includes("option")){const k=Number(r.split("-")[1]);k===b?i="option-1":i=`option-${k+1}`}else i="option-1";d(i)}function U(){if(r==="next")I();else if(r==="quit")z();else if(r.includes("option")){const i=Number(r.split("-")[1]);F(i-1)}d("")}function z(){t(j())}function F(i){t(Z(i)),c.correctOption===i&&(t(ee(c.points)),n&&xe.recordUserCorrectAnswer(c))}function I(){if(u===null)return;f>=0&&f<x-1?t(te()):v&&(t(q("finished")),a>m&&t(ne(a)))}function Y(){t(C(!w))}function K(){y&&(t(C(!1)),o(`question-edit/${c.id}`))}function W(){if(!y)return;const i={...c,isRevised:!c.isRevised};t(P(i,"approve"))}function _(){if(!y)return;const i={...c,isMarkedToBeRevised:!c.isMarkedToBeRevised};t(P(i,"mark"))}h.useEffect(()=>{function i(){r!==""&&d("")}return document.addEventListener("mousemove",i),()=>{document.removeEventListener("mousemove",i)}},[r]);const G={focusedBtn:r,question:c,isNextBtnShown:S,isLastQuestionIdx:v,onPassQuestion:I,handleQuitClick:z,onOptionSelection:F};return e(M.Provider,{value:G,children:s})}function Qe(){const s=h.useContext(M);if(s===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return s}const be=()=>{const{loggedInUser:s}=T(),t=s==null?void 0:s.roles.includes("admin"),{focusedBtn:o,question:n,isNextBtnShown:p,isLastQuestionIdx:f,onPassQuestion:x,handleQuitClick:u,onOptionSelection:a}=Qe(),{answerIdx:m}=N();return n?l("section",{className:"w-full max-w-[575px] px-14",children:[e(we,{}),l("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:n.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:n.options.map((w,r)=>{const d=m!==null,c=m===r,y=d&&n.correctOption===r;return e(Q,{className:B("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":c,correct:y,wrong:d&&!y,"translate-x-5 !bg-gray-800 text-gray-200":o===`option-${r+1}`,"!cursor-not-allowed":m!==null}),onClickFn:()=>a(r),disabled:d,children:w},r)})})]}),l(se,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(ye,{}),p&&e(Q,{onClickFn:x,className:B("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":o==="next"}),children:e("span",{children:f?"Finish":"Next"})}),e(Q,{onClickFn:u,className:B("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":o==="quit"}),children:e("span",{children:"Quit"})}),t&&l("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(Ne,{}),e(ae,{question:n}),e(ce,{question:n}),e(ue,{question:n}),e(de,{question:n}),e(fe,{questionId:n.id}),e(me,{question:n,isToggled:!0})]})]})]}):null},Be=()=>{const{questions:s,answers:t}=N();return l("div",{className:"flex h-full w-full flex-col items-center space-y-4 rounded-lg bg-gray-100 p-4",children:[e("h1",{className:"w-full text-center text-4xl font-bold text-gray-800",children:"Quiz Summary"}),e("ul",{className:"w-full flex flex-col items-start gap-4",children:s.map((o,n)=>l("li",{className:"quiz-summary flex w-full flex-col items-start space-y-2",children:[l("p",{className:"text-2xl font-semibold text-gray-800 break-words",children:[n+1,". ",o.question]}),o.correctOption===t[n]?l("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",o.options[t[n]]]}):l(E,{children:[l("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Correct Answer: ",o.options[o.correctOption]]}),l("p",{className:"wrong-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",o.options[t[n]]]})]})]},o.id))})]})},Ae=()=>{const s=A(),{language:t,level:o,page:n,points:p,maxPossiblePoints:f,highScore:x,numQuestions:u}=N(),a=p/f*100,[m,w]=h.useState("none"),r=h.useRef("none");let d;a===100?d="ðŸ¥³":a>=80?d="ðŸ˜Ž":a>=60?d="ðŸ™‚":d="ðŸ˜ž";function c(){s(O({language:t,level:o,page:n+1,limit:u}))}function y(){s(j())}g("ArrowRight",()=>{w(v=>"restart")}),g("ArrowLeft",()=>{w(v=>"newQuiz")}),g("Enter",()=>{const v=r.current;v==="newQuiz"?c():v==="restart"&&y()});function S(){w(v=>"none")}return h.useEffect(()=>(document.addEventListener("mousemove",S),()=>{document.removeEventListener("mousemove",S)}),[]),h.useEffect(()=>{r.current=m},[m]),l("section",{className:"flex flex-col items-center gap-12 px-4",children:[l("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:d}),"You scored ",e("strong",{children:p})," out of"," ",e("strong",{children:f})," points. (",Math.ceil(a),"%)"]}),l("p",{className:"text-center text-3xl",children:["(Highscore: ",x," points)"]}),l("div",{className:"flex items-center justify-center gap-5",children:[e(Q,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":m==="newQuiz"}),onClickFn:c,children:"Start New Quiz"}),e(Q,{className:B("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":m==="restart"}),onClickFn:y,children:"Restart"})]}),e(Be,{})]})},Se=()=>{const{language:s}=N(),t=re.programmingLanguages[s];if(!t)return null;const{img:o}=t;return l(oe,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:o,alt:"logo",className:"h-20 w-20 object-contain"})]})},ke=({children:s,className:t})=>e("main",{className:t,children:s}),Pe=()=>{const s=A(),{loggedInUser:t}=T(),{status:o,language:n,level:p,page:f,questions:x}=N();function u(a){switch(a){case"loading":return e(pe,{});case"error":return e(ge,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(he,{});case"active":return e(ve,{children:e(be,{})});case"finished":return e(Ae,{});default:return e(E,{})}}return h.useEffect(()=>{if(x.length>0)return;function a(){if(!t)s(O({language:n,level:p,page:f}));else{const{language:m,level:w,numQuestions:r,secondsPerQuestion:d}=t.quizSettings;s(O({language:m,level:w,limit:r,secondsPerQuestion:d}))}}return a(),()=>{a()}},[t,n,p,f,s,x.length]),l(ke,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(Se,{}),u(o),e(ie,{})]})};export{Pe as default};
