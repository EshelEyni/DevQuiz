import{u as S,q as j,y as v,r as x,b as T,z as q,a as l,j as e,F as E,w as C,A as X,M as Z,B as ee,C as te,D as L,E as ne,I as se,J as re,K as oe,t as R,N as ie,P as O,s as le,H as ae,O as ce}from"./index-0c9ae2a9.js";import{B as b,c as A}from"./Button-e6d1d7bb.js";import{u as p,q as ue,B as de}from"./useKey-1064ec92.js";import{a as fe,b as me,d as pe,c as xe,B as ge,Q as he}from"./QuestionLoader-4aacd1fc.js";import{u as we}from"./user.service-4fb3b6dd.js";import{E as ye}from"./ErrMsg-a0c3ba3c.js";import"./Modal-a82230cb.js";import"./useOutsideClick-255439c8.js";const Ne=()=>{const n=S(),t=j(),{language:o,numQuestions:s}=v(),[c,g]=x.useState(!1),{loggedInUser:u}=T();p("Enter",h),p("ArrowDown",d),p("ArrowUp",a);function h(){n(q("active"))}function a(){g(!1)}function d(){g(!0)}function w(){u&&t(`/profile/${u.id}`)}return l("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${o} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${s} question to test your ${o} mastery`}),s>0?e(b,{onClickFn:h,className:A("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":c}),children:"Let's start"}):l(E,{children:[e("p",{className:"mt-10 text-center text-2xl font-bold text-gray-50",children:"You have completed all the questions. Go to profile to reset the questions."}),e(b,{onClickFn:w,className:"mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",children:"Go to Profile"})]})]})},ve=()=>{const{numQuestions:n,questionIdx:t,points:o,maxPossiblePoints:s,answerIdx:c}=v();return l("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(c!==null),max:n,className:"quiz-progress-bar col-span-full h-4 w-full"}),l("p",{children:["Question ",e("strong",{children:t+1}),"/",n]}),l("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:o}),"/",s]})]})},Qe=()=>{const n=S(),{questions:t,isTimerOn:o,secondsPerQuestion:s}=v(),[c,g]=x.useState(t.length*s),u=x.useRef(null),h=Math.floor(c/60),a=c%60;function d(){u.current&&clearInterval(u.current)}return x.useEffect(()=>(n(C(!0)),()=>{n(C(!1))}),[n]),x.useEffect(()=>{function w(){u.current=setInterval(()=>{g(m=>m===0?(n(q("finished")),m):m-1)},1e3)}return o?w():d(),()=>{d()}},[o,n]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:l("span",{children:[h<10&&"0",h,":",a<10&&"0",a]})})},be=()=>{const n=S(),{isTimerOn:t}=v();function o(){n(C(!t))}const s=x.useRef(X()).current;return l(E,{children:[e("button",{onClick:o,"data-tooltip-id":s,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(Z,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(ee,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(ue,{id:s,style:{fontSize:"16px"},className:"hidden md:block"})]})},M=x.createContext(void 0);function Be({children:n}){const t=S(),o=te(),s=j(),{loggedInUser:c}=T(),{questions:g,questionIdx:u,numQuestions:h,answerIdx:a,points:d,highScore:w,isTimerOn:m}=v(),[r,N]=x.useState(""),Q=o.pathname.includes("question-edit"),f=g[u],y=c==null?void 0:c.roles.includes("admin"),$=a!==null,z=u===h-1;p("Enter",K,{},[r]),p("ArrowRight",H,{},[r]),p("ArrowLeft",D,{},[r]),p("ArrowUp",U,{},[a,r]),p("ArrowDown",Y,{},[a,r]),p("e",_,{},[f.id,y,Q]),p("a",G,{},[y,f.isRevised]),p("m",V,{},[y,f.isMarkedToBeRevised]),p("t",W,{},[m]);function H(){N("next")}function D(){N("quit")}function U(){if(a)return;let i="";const B=f.options.length;if(r==="")i="option-1";else if(r.includes("option")){const k=Number(r.split("-")[1]);k===1?i=`option-${B}`:i=`option-${k-1}`}else r?i=`option-${B+1}`:i="option-1";N(i)}function Y(){if(a)return;let i="";const B=f.options.length;if(r.includes("option")){const k=Number(r.split("-")[1]);k===B?i="option-1":i=`option-${k+1}`}else i="option-1";N(i)}function K(){if(r==="next")I();else if(r==="quit")P();else if(r.includes("option")){const i=Number(r.split("-")[1]);F(i-1)}N("")}function P(){t(L())}function F(i){t(ne(i)),f.correctOption===i&&(t(se(f.points)),c&&we.recordUserCorrectAnswer(f))}function I(){if(a===null)return;u>=0&&u<h-1?t(re()):z&&(t(q("finished")),d>w&&t(oe(d)))}function W(){t(C(!m))}function _(){!y||Q||(t(C(!1)),s(`question-edit/${f.id}`))}function G(){if(!y)return;const i={...f,isRevised:!f.isRevised};t(R(i,"approve"))}function V(){if(!y)return;const i={...f,isMarkedToBeRevised:!f.isMarkedToBeRevised};t(R(i,"mark"))}x.useEffect(()=>{function i(){r!==""&&N("")}return document.addEventListener("mousemove",i),()=>{document.removeEventListener("mousemove",i)}},[r]);const J={focusedBtn:r,question:f,isNextBtnShown:$,isLastQuestionIdx:z,onPassQuestion:I,handleQuitClick:P,onOptionSelection:F};return e(M.Provider,{value:J,children:n})}function Ae(){const n=x.useContext(M);if(n===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return n}const Se=()=>{const{loggedInUser:n}=T(),t=n==null?void 0:n.roles.includes("admin"),{focusedBtn:o,question:s,isNextBtnShown:c,isLastQuestionIdx:g,onPassQuestion:u,handleQuitClick:h,onOptionSelection:a}=Ae(),{answerIdx:d}=v();return s?l("section",{className:"w-full max-w-[575px] px-14",children:[e(ve,{}),l("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:s.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:s.options.map((w,m)=>{const r=d!==null,N=d===m,Q=r&&s.correctOption===m;return e(b,{className:A("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":N,correct:Q,wrong:r&&!Q,"translate-x-5 !bg-gray-800 text-gray-200":o===`option-${m+1}`,"!cursor-not-allowed":d!==null}),onClickFn:()=>a(m),disabled:r,children:w},m)})})]}),l(ie,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(Qe,{}),c&&e(b,{onClickFn:u,className:A("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":o==="next"}),children:e("span",{children:g?"Finish":"Next"})}),e(b,{onClickFn:h,className:A("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":o==="quit"}),children:e("span",{children:"Quit"})}),t&&l("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(be,{}),e(de,{question:s}),e(fe,{question:s}),e(me,{question:s}),e(pe,{question:s}),e(xe,{questionId:s.id}),e(ge,{question:s,isToggled:!0})]})]})]}):null},ke=()=>{const{questions:n,answers:t}=v();return l("div",{className:"flex h-full w-full flex-col items-center space-y-4 rounded-lg bg-gray-100 p-4",children:[e("h1",{className:"w-full text-center text-4xl font-bold text-gray-800",children:"Quiz Summary"}),e("ul",{className:"w-full flex flex-col items-start gap-4",children:n.map((o,s)=>l("li",{className:"quiz-summary flex w-full flex-col items-start space-y-2",children:[l("p",{className:"text-2xl font-semibold text-gray-800 break-words",children:[s+1,". ",o.question]}),o.correctOption===t[s]?l("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",o.options[t[s]]]}):l(E,{children:[l("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Correct Answer: ",o.options[o.correctOption]]}),l("p",{className:"wrong-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",o.options[t[s]]]})]})]},o.id))})]})},Ce=()=>{const n=S(),{language:t,level:o,page:s,points:c,maxPossiblePoints:g,highScore:u,numQuestions:h}=v(),a=c/g*100,[d,w]=x.useState("none"),m=x.useRef("none");let r;a===100?r="ðŸ¥³":a>=80?r="ðŸ˜Ž":a>=60?r="ðŸ™‚":r="ðŸ˜ž";function N(){n(O({language:t,level:o,page:s+1,limit:h}))}function Q(){n(L())}p("ArrowRight",()=>{w(y=>"restart")}),p("ArrowLeft",()=>{w(y=>"newQuiz")}),p("Enter",()=>{const y=m.current;y==="newQuiz"?N():y==="restart"&&Q()});function f(){w(y=>"none")}return x.useEffect(()=>(document.addEventListener("mousemove",f),()=>{document.removeEventListener("mousemove",f)}),[]),x.useEffect(()=>{m.current=d},[d]),l("section",{className:"flex flex-col items-center gap-12 px-4",children:[l("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:r}),"You scored ",e("strong",{children:c})," out of"," ",e("strong",{children:g})," points. (",Math.ceil(a),"%)"]}),l("p",{className:"text-center text-3xl",children:["(Highscore: ",u," points)"]}),l("div",{className:"flex items-center justify-center gap-5",children:[e(b,{className:A("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":d==="newQuiz"}),onClickFn:N,children:"Start New Quiz"}),e(b,{className:A("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":d==="restart"}),onClickFn:Q,children:"Restart"})]}),e(ke,{})]})},Te=()=>{const{language:n}=v(),t=le.programmingLanguages[n];if(!t)return null;const{img:o}=t;return l(ae,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:o,alt:"logo",className:"h-20 w-20 object-contain"})]})},Ee=({children:n,className:t})=>e("main",{className:t,children:n}),Le=()=>{const n=S(),{loggedInUser:t}=T(),{status:o,language:s,level:c,page:g,questions:u}=v();function h(a){switch(a){case"loading":return e(he,{});case"error":return e(ye,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(Ne,{});case"active":return e(Be,{children:e(Se,{})});case"finished":return e(Ce,{});default:return e(E,{})}}return x.useEffect(()=>{if(u.length>0)return;function a(){if(!t)n(O({language:s,level:c,page:g}));else{const{language:d,level:w,numQuestions:m,secondsPerQuestion:r}=t.quizSettings;n(O({language:d,level:w,limit:m,secondsPerQuestion:r}))}}return a(),()=>{a()}},[t,s,c,g,n,u.length]),l(Ee,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(Te,{}),h(o),e(ce,{})]})};export{Le as default};
