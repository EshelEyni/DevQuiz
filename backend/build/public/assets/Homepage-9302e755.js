import{b as k,a as z,P as v,r as x,l as E,Q as O,c as a,j as e,F as C,M as T,m as X,R as Z,S as ee,T as te,U as j,V as ne,W as se,X as re,Y as oe,J as R,Z as ie,$ as M,w as ae,I as le,O as ce}from"./index-4c13b4f8.js";import{B as b,c as S}from"./Button-1c7b815b.js";import{u as p,q as ue,B as de}from"./useKey-63d42789.js";import{a as fe,b as me,d as pe,c as xe,B as ge,Q as he}from"./QuestionLoader-42ef3189.js";import{u as we}from"./user.service-f51dc92f.js";import{M as ye}from"./Main-2fafb17a.js";import{E as Ne}from"./ErrMsg-17ec230e.js";import"./index.esm-ebd52be7.js";import"./Modal-dbac4fe4.js";import"./useOutsideClick-ae0e3bbc.js";const ve=()=>{const n=k(),t=z(),{language:r,numQuestions:s}=v(),[c,h]=x.useState(!1),{loggedInUser:d}=E();p("Enter",g),p("ArrowDown",f),p("ArrowUp",l);function g(){n(O("active"))}function l(){h(!1)}function f(){h(!0)}function y(){d&&t(`/profile/${d.id}`)}return a("div",{className:"flex flex-1 flex-col items-center gap-3 px-3",children:[e("h2",{className:"w-full text-center text-4xl font-bold text-gray-50",children:`Welcome to The ${r} Quiz!`}),e("h3",{className:"w-full text-center text-xl font-bold text-gray-50 ",children:`${s} question to test your ${r} mastery`}),s>0?e(b,{onClickFn:g,className:S("mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":c}),children:"Let's start"}):a(C,{children:[e("p",{className:"mt-10 text-center text-2xl font-bold text-gray-50",children:"You have completed all the questions. Go to profile to reset the questions."}),e(b,{onClickFn:y,className:"mt-10 rounded-full bg-gray-600 px-8 py-6 text-3xl font-medium uppercase text-gray-100 transition-all duration-300",children:"Go to Profile"})]})]})},Qe=()=>{const{numQuestions:n,questionIdx:t,points:r,maxPossiblePoints:s,answerIdx:c}=v();return a("div",{className:"mb-16 grid grid-cols-2 gap-5 text-2xl",children:[e("progress",{value:t+ +(c!==null),max:n,className:"quiz-progress-bar col-span-full h-4 w-full"}),a("p",{children:["Question ",e("strong",{children:t+1}),"/",n]}),a("p",{className:"justify-self-end text-end",children:["Points ",e("strong",{children:r}),"/",s]})]})},be=()=>{const n=k(),{questions:t,isTimerOn:r,secondsPerQuestion:s}=v(),[c,h]=x.useState(t.length*s),d=x.useRef(null),g=Math.floor(c/60),l=c%60;function f(){d.current&&clearInterval(d.current)}return x.useEffect(()=>(n(T(!0)),()=>{n(T(!1))}),[n]),x.useEffect(()=>{function y(){d.current=setInterval(()=>{h(m=>m===0?(n(O("finished")),m):m-1)},1e3)}return r?y():f(),()=>{f()}},[r,n]),e("div",{className:"col-start-1 row-start-1 flex h-16 items-center justify-center justify-self-start rounded-[100px] border-2 border-gray-200 px-8 text-3xl text-gray-200",children:a("span",{children:[g<10&&"0",g,":",l<10&&"0",l]})})},Be=()=>{const n=k(),{isTimerOn:t}=v();function r(){n(T(!t))}const s=x.useRef(X()).current;return a(C,{children:[e("button",{onClick:r,"data-tooltip-id":s,"data-tooltip-content":"Toggle timer","data-tooltip-place":"top",children:t?e(Z,{color:"#f1f3f5",className:"text-5xl md:text-4xl"}):e(ee,{color:"#f1f3f5",className:"text-5xl md:text-4xl"})}),e(ue,{id:s,style:{fontSize:"16px"},className:"hidden md:block"})]})},L=x.createContext(void 0);function Se({children:n}){const t=k(),r=te(),s=z(),{loggedInUser:c}=E(),{questions:h,questionIdx:d,numQuestions:g,answerIdx:l,points:f,highScore:y,isTimerOn:m}=v(),[o,N]=x.useState(""),Q=r.pathname.includes("question-edit"),u=h[d],w=c==null?void 0:c.roles.includes("admin"),$=l!==null,P=d===g-1;p("Enter",W,{},[o]),p("ArrowRight",H,{},[o]),p("ArrowLeft",D,{},[o]),p("ArrowUp",U,{},[l,o]),p("ArrowDown",Y,{},[l,o]),p("e",_,{},[u.id,w,Q]),p("a",G,{},[w,u.isRevised]),p("m",K,{},[w,u.isMarkedToBeRevised]),p("t",V,{},[m]);function H(){N("next")}function D(){N("quit")}function U(){if(l)return;let i="";const B=u.options.length;if(o==="")i="option-1";else if(o.includes("option")){const A=Number(o.split("-")[1]);A===1?i=`option-${B}`:i=`option-${A-1}`}else o?i=`option-${B+1}`:i="option-1";N(i)}function Y(){if(l)return;let i="";const B=u.options.length;if(o.includes("option")){const A=Number(o.split("-")[1]);A===B?i="option-1":i=`option-${A+1}`}else i="option-1";N(i)}function W(){if(o==="next")I();else if(o==="quit")q();else if(o.includes("option")){const i=Number(o.split("-")[1]);F(i-1)}N("")}function q(){t(j())}function F(i){t(ne(i)),u.correctOption===i&&(t(se(u.points)),c&&we.recordUserCorrectAnswer(u))}function I(){if(l===null)return;d>=0&&d<g-1?t(re()):P&&(t(O("finished")),f>y&&t(oe(f)))}function V(){t(T(!m))}function _(){!w||Q||(t(T(!1)),s(`question-edit/${u.id}`))}function G(){if(!w)return;const i={...u,isRevised:!u.isRevised};t(R(i,"approve"))}function K(){if(!w)return;const i={...u,isMarkedToBeRevised:!u.isMarkedToBeRevised};t(R(i,"mark"))}x.useEffect(()=>{function i(){o!==""&&N("")}return document.addEventListener("mousemove",i),()=>{document.removeEventListener("mousemove",i)}},[o]);const J={focusedBtn:o,question:u,isNextBtnShown:$,isLastQuestionIdx:P,onPassQuestion:I,handleQuitClick:q,onOptionSelection:F};return e(L.Provider,{value:J,children:n})}function ke(){const n=x.useContext(L);if(n===void 0)throw new Error("useQuestion must be used within a QuestionProvider");return n}const Ae=()=>{const{loggedInUser:n}=E(),t=n==null?void 0:n.roles.includes("admin"),{focusedBtn:r,question:s,isNextBtnShown:c,isLastQuestionIdx:h,onPassQuestion:d,handleQuitClick:g,onOptionSelection:l}=ke(),{answerIdx:f}=v();return s?a("section",{className:"w-full max-w-[575px] px-14",children:[e(Qe,{}),a("div",{children:[e("div",{className:"question-header",children:e("h4",{className:"mb-16 text-4xl font-bold text-gray-50 md:text-3xl",children:s.question})}),e("ul",{className:"mb-4 flex flex-col gap-4",children:s.options.map((y,m)=>{const o=f!==null,N=f===m,Q=o&&s.correctOption===m;return e(b,{className:S("option-display w-full cursor-pointer rounded-full bg-gray-600 px-10 py-5 text-left text-3xl transition-all duration-300",{"translate-x-10":N,correct:Q,wrong:o&&!Q,"translate-x-5 !bg-gray-800 text-gray-200":r===`option-${m+1}`,"!cursor-not-allowed":f!==null}),onClickFn:()=>l(m),disabled:o,children:y},m)})})]}),a(ie,{className:"grid grid-cols-2 grid-rows-2	items-center gap-4",children:[e(be,{}),c&&e(b,{onClickFn:d,className:S("col-start-2 row-start-1 flex h-20 items-center justify-center justify-self-end rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":r==="next"}),children:e("span",{children:h?"Finish":"Next"})}),e(b,{onClickFn:g,className:S("col-start-1 row-start-2 flex h-20 items-center justify-center justify-self-start rounded-full bg-gray-600 px-7 text-3xl font-medium leading-none tracking-wide text-gray-100 transition-all duration-300 hover:scale-110 md:h-14 md:text-2xl",{"scale-110 bg-gray-800 text-gray-200":r==="quit"}),children:e("span",{children:"Quit"})}),t&&a("div",{className:"col-start-2 row-start-2 flex  items-center justify-center gap-3 justify-self-end",children:[e(Be,{}),e(de,{question:s}),e(fe,{question:s}),e(me,{question:s}),e(pe,{question:s}),e(xe,{questionId:s.id}),e(ge,{question:s,isToggled:!0})]})]})]}):null},Te=()=>{const{questions:n,answers:t}=v();return a("div",{className:"flex h-full w-full flex-col items-center space-y-4 rounded-lg bg-gray-100 p-4",children:[e("h1",{className:"w-full text-center text-4xl font-bold text-gray-800",children:"Quiz Summary"}),e("ul",{className:"w-full flex flex-col items-start gap-4",children:n.map((r,s)=>a("li",{className:"quiz-summary flex w-full flex-col items-start space-y-2",children:[a("p",{className:"text-2xl font-semibold text-gray-800 break-words",children:[s+1,". ",r.question]}),r.correctOption===t[s]?a("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",r.options[t[s]]]}):a(C,{children:[a("p",{className:"correct-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Correct Answer: ",r.options[r.correctOption]]}),a("p",{className:"wrong-answer rounded-lg px-3 py-1 text-xl font-medium",children:["Your Answer: ",r.options[t[s]]]})]})]},r.id))})]})},Ce=()=>{const n=k(),{language:t,level:r,page:s,points:c,maxPossiblePoints:h,highScore:d,numQuestions:g}=v(),l=c/h*100,[f,y]=x.useState("none"),m=x.useRef("none");let o;l===100?o="ðŸ¥³":l>=80?o="ðŸ˜Ž":l>=60?o="ðŸ™‚":o="ðŸ˜ž";function N(){n(M({language:t,level:r,page:s+1,limit:g}))}function Q(){n(j())}p("ArrowRight",()=>{y(w=>"restart")}),p("ArrowLeft",()=>{y(w=>"newQuiz")}),p("Enter",()=>{const w=m.current;w==="newQuiz"?N():w==="restart"&&Q()});function u(){y(w=>"none")}return x.useEffect(()=>(document.addEventListener("mousemove",u),()=>{document.removeEventListener("mousemove",u)}),[]),x.useEffect(()=>{m.current=f},[f]),a("section",{className:"flex flex-col items-center gap-12 px-4",children:[a("p",{className:"rounded-full px-6 py-8 text-center text-4xl font-medium",style:{background:"var(--color-theme)"},children:[e("span",{className:"mr-[4px] text-4xl",children:o}),"You scored ",e("strong",{children:c})," out of"," ",e("strong",{children:h})," points. (",Math.ceil(l),"%)"]}),a("p",{className:"text-center text-3xl",children:["(Highscore: ",d," points)"]}),a("div",{className:"flex items-center justify-center gap-5",children:[e(b,{className:S("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":f==="newQuiz"}),onClickFn:N,children:"Start New Quiz"}),e(b,{className:S("cursor-pointer rounded-full bg-gray-600 px-10 py-7 text-3xl font-medium text-gray-100 transition-all duration-300",{"scale-110 bg-gray-800 text-gray-200":f==="restart"}),onClickFn:Q,children:"Restart"})]}),e(Te,{})]})},Ee=()=>{const{language:n}=v(),t=ae.programmingLanguages[n];if(!t)return null;const{img:r}=t;return a(le,{className:"mb-12 mt-6 flex w-full items-center justify-center gap-5 px-10",children:[e("h1",{className:"text-6xl font-bold text-gray-50",children:"DevQuiz"}),e("img",{src:r,alt:"logo",className:"h-20 w-20 object-contain"})]})},$e=()=>{const n=k(),{status:t,language:r,level:s,page:c,secondsPerQuestion:h,questions:d}=v();function g(l){switch(l){case"loading":return e(he,{});case"error":return e(Ne,{msg:"There was an error fetching questions. Please try again later."});case"ready":return e(ve,{});case"active":return e(Se,{children:e(Ae,{})});case"finished":return e(Ce,{});default:return e(C,{})}}return x.useEffect(()=>{d.length||n(M({language:r,level:s,page:c,secondsPerQuestion:h}))},[n]),a(ye,{className:"flex w-full flex-1 flex-col items-center pb-24",children:[e(Ee,{}),g(t),e(ce,{})]})};export{$e as default};
